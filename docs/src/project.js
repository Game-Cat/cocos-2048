window.__require=function o(t,i,s){function e(h,l){if(!i[h]){if(!t[h]){var r=h.split("/");if(r=r[r.length-1],!t[r]){var n="function"==typeof __require&&__require;if(!l&&n)return n(r,!0);if(c)return c(r,!0);throw new Error("Cannot find module '"+h+"'")}}var a=i[h]={exports:{}};t[h][0].call(a.exports,function(o){return e(t[h][1][o]||o)},a,a.exports,o,t,i,s)}return i[h].exports}for(var c="function"==typeof __require&&__require,h=0;h<s.length;h++)e(s[h]);return e}({BackgroundPad:[function(o,t,i){"use strict";cc._RF.push(t,"0587cmRhilEXr9RhZc/3izf","BackgroundPad"),cc.Class({extends:cc.Component,properties:{blockOffset:20,backColor:new cc.Color(206,194,178,255),spriteFrame:cc.SpriteFrame,blockRow:4,blockCol:4},onLoad:function(){this.node.height=this.node.width;for(var o=(this.node.width-(this.blockRow+1)*this.blockOffset)/this.blockRow,t=(this.node.height-(this.blockCol+1)*this.blockOffset)/this.blockCol,i=this.blockOffset-this.node.width/2+o/2,s=this.node.height/2-this.blockOffset-t/2,e=0;e<this.blockRow;e++)for(var c=0;c<this.blockCol;c++){var h=new cc.Node;h.addComponent(cc.Sprite).spriteFrame=this.spriteFrame,h.color=this.backColor,h.width=o,h.height=t,h.parent=this.node,h.x=i+e*o+e*this.blockOffset,h.y=s-c*t-c*this.blockOffset}}}),cc._RF.pop()},{}],Block:[function(o,t,i){"use strict";cc._RF.push(t,"c401c/EV15PI6o3EqS6YjSU","Block"),cc.Class({extends:cc.Component,properties:{numLable:cc.Label,num:2,colorNode:{default:[],type:cc.Color},colorText:{default:[],type:cc.Color},scaleDelay:.2},ResetPara:function(o){this.num=o,this.numLable.string=o.toString();var t=Math.log2(this.num)-1;t>=0&&t<this.colorText.length&&t<this.colorNode.length&&(this.numLable.node.color=this.colorText[t],this.node.color=this.colorNode[t])},reuse:function(o,t){this.node.width=o,this.node.height=t;var i=Math.round(Math.random()+1);this.SetNum(2*i),this.node.scale=.2,this.node.opacity=255;var s=cc.scaleTo(this.scaleDelay,1);this.node.runAction(s)},GetNum:function(){return this.num},SetNum:function(o){this.ResetPara(o)}}),cc._RF.pop()},{}],GameControl:[function(o,t,i){"use strict";cc._RF.push(t,"bdfdc4rJzdC86T3pXxfllFX","GameControl"),cc.Class({extends:cc.Component,properties:{gamePad:cc.Node},onLoad:function(){this.node.on("touchstart",this.onTouchDown,this),this.node.on("touchend",this.onTouchUp,this),this.gamePadScripter=this.gamePad.getComponent("GamePad")},onTouchDown:function(o){this.posDown=cc.v2(o.touch._point)},onTouchUp:function(o){var t=o.touch._point.x-this.posDown.x,i=o.touch._point.y-this.posDown.y;Math.abs(t)>Math.abs(i)?t>50?this.gamePadScripter.MoveRight():t<-50&&this.gamePadScripter.MoveLeft():i>50?this.gamePadScripter.MoveUp():i<-50&&this.gamePadScripter.MoveDown()}}),cc._RF.pop()},{}],GamePad:[function(o,t,i){"use strict";cc._RF.push(t,"dfe5blHowZF/KsyTqHMDQyf","GamePad"),cc.Class({extends:cc.Component,properties:{score:cc.Label,bestScore:cc.Label,blockPrefab:cc.Prefab,blockOffset:20,blockRow:4,blockCol:4,clickAudio:{default:null,type:cc.AudioClip},moveAudio:{default:null,type:cc.AudioClip},winAudio:{default:null,type:cc.AudioClip},lostAudio:{default:null,type:cc.AudioClip},moveDelay:.1},ResetGame:function(){this.NewGame(),this.PlayAudio(this.clickAudio)},NewGame:function(){for(;this.node.childrenCount>0;)this.blockPool.put(this.node.children[0]);this.noneBlockPos=[],this.blockNum=[];for(var o=0;o<this.blockRow*this.blockCol;o++)this.noneBlockPos.push(o),this.blockNum.push(null);this.maxScore=0;for(var t=0;t<2;t++){var i=this.CreateBlock();i>this.maxScore&&(this.maxScore=i)}this.score.string=this.maxScore.toString();var s=cc.sys.localStorage.getItem("best");null===s||""===s?(this.bestScore.string=this.maxScore.toString(),this.gameBestScore=this.maxScore,cc.sys.localStorage.setItem("best",this.gameBestScore)):(this.bestScore.string=s.toString(),this.gameBestScore=s)},CreateBlock:function(){if(this.noneBlockPos.length<=0)return 0;var o=null;this.blockPool.size()>0?o=this.blockPool.get(this.blockWidth,this.blockHigh):(o=cc.instantiate(this.blockPrefab)).getComponent("Block").reuse(this.blockWidth,this.blockHigh),o.parent=this.node;var t=Math.floor(this.noneBlockPos.length*Math.random()),i=this.noneBlockPos[t];this.noneBlockPos.splice(t,1),this.blockNum[i]=o.getComponent("Block");var s=i%this.blockCol,e=Math.floor(i/this.blockCol);return o.x=this.startPosX+s*this.blockWidth+s*this.blockOffset,o.y=this.startPosY-e*this.blockHigh-e*this.blockOffset,this.blockNum[i].GetNum()},onLoad:function(){this.blockPool=new cc.NodePool("Block"),this.blockWidth=(this.node.width-(this.blockRow+1)*this.blockOffset)/this.blockRow,this.blockHigh=(this.node.height-(this.blockCol+1)*this.blockOffset)/this.blockCol,this.startPosX=this.blockOffset-this.node.width/2+this.blockWidth/2,this.startPosY=this.node.height/2-this.blockOffset-this.blockHigh/2,this.NewGame(),this.targetSocre=2048},PlayAudio:function(o){null!==o&&cc.audioEngine.playEffect(o,!1)},MoveFinish:function(o){this.blockPool.put(o)},MoveBlock:function(o,t,i,s){var e=0;if(null===this.blockNum[o*this.blockCol+t]){var c=this.startPosX+t*this.blockWidth+t*this.blockOffset,h=this.startPosY-o*this.blockHigh-o*this.blockOffset,l=this.blockNum[i*this.blockCol+s].node,r=cc.moveTo(this.moveDelay,c,h);l.runAction(r),this.blockNum[o*this.blockCol+t]=this.blockNum[i*this.blockCol+s],this.blockNum[i*this.blockCol+s]=null,this.noneBlockPos.push(i*this.blockCol+s);var n=this.noneBlockPos.indexOf(o*this.blockCol+t);n>=0&&this.noneBlockPos.splice(n,1),e=1}else if(this.blockNum[o*this.blockCol+t].GetNum()===this.blockNum[i*this.blockCol+s].GetNum()){var a=this.startPosX+t*this.blockWidth+t*this.blockOffset,u=this.startPosY-o*this.blockHigh-o*this.blockOffset,k=this.blockNum[i*this.blockCol+s].node,b=cc.spawn(cc.moveTo(this.moveDelay,a,u),cc.fadeOut(this.moveDelay)),f=cc.callFunc(this.MoveFinish,this,k);k.runAction(cc.sequence(b,f));var d=2*this.blockNum[o*this.blockCol+t].GetNum();this.blockNum[o*this.blockCol+t].SetNum(d),this.blockNum[i*this.blockCol+s]=null,this.noneBlockPos.push(i*this.blockCol+s),this.maxScore<d&&(d>=this.targetSocre&&this.PlayAudio(this.winAudio),this.maxScore=d,this.score.string=d.toString(),this.gameBestScore<d&&(this.bestScore.string=d.toString(),this.gameBestScore=d,cc.sys.localStorage.setItem("best",this.gameBestScore))),e=2}return e},CheckGameOver:function(){if(!(this.noneBlockPos.length<=0))return!1;for(var o=0;o<this.blockRow-1;o++)for(var t=0;t<this.blockCol-1;t++){if(this.blockNum[o*this.blockCol+t].GetNum()==this.blockNum[o*this.blockCol+t+1].GetNum())return!1;if(this.blockNum[(o+1)*this.blockCol+t].GetNum()==this.blockNum[(o+1)*this.blockCol+t+1].GetNum())return!1;if(this.blockNum[o*this.blockCol+t].GetNum()==this.blockNum[(o+1)*this.blockCol+t].GetNum())return!1;if(this.blockNum[o*this.blockCol+t+1].GetNum()==this.blockNum[(o+1)*this.blockCol+t+1].GetNum())return!1}return!0},MoveLeft:function(){for(var o=0,t=0;t<this.blockRow;t++)for(var i=0;i<this.blockCol;i++){for(var s=-1,e=i+1;e<this.blockCol;e++)if(null!==this.blockNum[t*this.blockCol+e]){s=e;break}if(-1!==s){var c=this.MoveBlock(t,i,t,s);o=c+o,1===c&&i--}}o>0&&this.CreateBlock(),this.CheckGameOver()?this.PlayAudio(this.lostAudio):this.PlayAudio(this.moveAudio)},MoveRight:function(){for(var o=0,t=0;t<this.blockRow;t++)for(var i=this.blockCol-1;i>=0;i--){for(var s=-1,e=i-1;e>=0;e--)if(null!==this.blockNum[t*this.blockCol+e]){s=e;break}if(-1!==s){var c=this.MoveBlock(t,i,t,s);o=c+o,1===c&&i++}}o>0&&this.CreateBlock(),this.CheckGameOver()?this.PlayAudio(this.lostAudio):this.PlayAudio(this.moveAudio)},MoveDown:function(){for(var o=0,t=0;t<this.blockCol;t++)for(var i=this.blockRow-1;i>=0;i--){for(var s=-1,e=i-1;e>=0;e--)if(null!==this.blockNum[e*this.blockCol+t]){s=e;break}if(-1!==s){var c=this.MoveBlock(i,t,s,t);o=c+o,1==c&&i++}}o>0&&this.CreateBlock(),this.CheckGameOver()?this.PlayAudio(this.lostAudio):this.PlayAudio(this.moveAudio)},MoveUp:function(){for(var o=0,t=0;t<this.blockCol;t++)for(var i=0;i<this.blockRow;i++){for(var s=-1,e=i+1;e<this.blockRow;e++)if(null!==this.blockNum[e*this.blockCol+t]){s=e;break}if(-1!==s){var c=this.MoveBlock(i,t,s,t);o=c+o,1==c&&i--}}o>0&&this.CreateBlock(),this.CheckGameOver()?this.PlayAudio(this.lostAudio):this.PlayAudio(this.moveAudio)}}),cc._RF.pop()},{}]},{},["BackgroundPad","Block","GameControl","GamePad"]);